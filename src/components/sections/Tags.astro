---
import { getCollection } from "astro:content";
import Typography from "../Typography.astro";
import { getLangFromUrl, getTransalations } from "../../i18n";
import Section from "./Section.astro";
import Link from "../Link.astro";

const lang = getLangFromUrl(Astro.url);
const t = getTransalations(lang);

const posts = await getCollection("blog");
const tags = Array.from(
  posts.reduce((tags, post) => {
    if (post.data.tags) {
      post.data.tags.forEach((tag) => {
        tags.add(tag);
      });
    }
    return tags;
  }, new Set())
);
---

<Section title={t("section.tags")}>
  <div>
    {
      tags.length === 0 && (
        <Typography variant="body2">{t("tags.empty")}</Typography>
      )
    }

    {tags.map((tag) => <Link href={`/tags/${tag}`}>{tag}</Link>)}
  </div>
</Section>
